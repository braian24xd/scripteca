{"ast":null,"code":"import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Route,Routes,Navigate}from'react-router-dom';import LandingPage from'./pages/LandingPage';import Login from'./pages/Login';import StudentRecordings from'./pages/StudentRecordings';import AdminDashboard from'./pages/AdminDashboard';import ManageUsers from'./pages/ManageUsers';import ManageRecordings from'./pages/ManageRecordings';import Account from'./pages/Account';import Header from'./components/Header';import{jwtDecode}from'jwt-decode';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{requiredRole,children}=_ref;const token=localStorage.getItem('token');// Obtener el token\nlet user=null;if(token){try{user=jwtDecode(token);// Decodificar el token\n}catch(error){console.error('Token inválido:',error);}}if(!user){// Si no hay usuario autenticado, redirigir al login\nreturn/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});}if(!requiredRole.includes(user.role)){// Si el rol no coincide, redirigir según el rol del usuario\nreturn user.role==='student'?/*#__PURE__*/_jsx(Navigate,{to:\"/recordings\"}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});}return children;// Renderizar contenido si el usuario cumple con los requisitos\n};const App=()=>{const[user,setUser]=useState(null);useEffect(()=>{const token=localStorage.getItem('token');if(token){try{const decodedUser=jwtDecode(token);setUser(decodedUser);}catch(error){console.error('Error al decodificar el token:',error);}}},[]);const logout=()=>{localStorage.removeItem('token');// Limpiar el token del almacenamiento local\nsetUser(null);// Actualizar el estado del usuario\n};return/*#__PURE__*/_jsxs(Router,{children:[user&&/*#__PURE__*/_jsx(Header,{user:user,logout:logout}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LandingPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/recordings\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:['student'],children:/*#__PURE__*/_jsx(StudentRecordings,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/account\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:['student','admin'],children:/*#__PURE__*/_jsx(Account,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:['admin'],children:/*#__PURE__*/_jsx(AdminDashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/users\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:['admin'],children:/*#__PURE__*/_jsx(ManageUsers,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/recordings\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:['admin'],children:/*#__PURE__*/_jsx(ManageRecordings,{})})})]})]});};export default App;// nuevo codigo","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Route","Routes","Navigate","LandingPage","Login","StudentRecordings","AdminDashboard","ManageUsers","ManageRecordings","Account","Header","jwtDecode","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","requiredRole","children","token","localStorage","getItem","user","error","console","to","includes","role","App","setUser","decodedUser","logout","removeItem","path","element"],"sources":["C:/Users/braya/OneDrive/Escritorio/scripteca/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Route, Routes, Navigate } from 'react-router-dom';\nimport LandingPage from './pages/LandingPage';\nimport Login from './pages/Login';\nimport StudentRecordings from './pages/StudentRecordings';\nimport AdminDashboard from './pages/AdminDashboard';\nimport ManageUsers from './pages/ManageUsers';\nimport ManageRecordings from './pages/ManageRecordings';\nimport Account from './pages/Account';\nimport Header from './components/Header';\nimport {jwtDecode} from 'jwt-decode';\n\nconst ProtectedRoute = ({ requiredRole, children }) => {\n  const token = localStorage.getItem('token'); // Obtener el token\n  let user = null;\n\n  if (token) {\n    try {\n      user = jwtDecode(token); // Decodificar el token\n    } catch (error) {\n      console.error('Token inválido:', error);\n    }\n  }\n\n  if (!user) {\n    // Si no hay usuario autenticado, redirigir al login\n    return <Navigate to=\"/login\" />;\n  }\n\n  if (!requiredRole.includes(user.role)) {\n    // Si el rol no coincide, redirigir según el rol del usuario\n    return user.role === 'student' ? (\n      <Navigate to=\"/recordings\" />\n    ) : (\n      <Navigate to=\"/login\" />\n    );\n  }\n\n  return children; // Renderizar contenido si el usuario cumple con los requisitos\n};\n\nconst App = () => {\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      try {\n        const decodedUser = jwtDecode(token);\n        setUser(decodedUser);\n      } catch (error) {\n        console.error('Error al decodificar el token:', error);\n      }\n    }\n  }, []);\n\n  const logout = () => {\n    localStorage.removeItem('token'); // Limpiar el token del almacenamiento local\n    setUser(null); // Actualizar el estado del usuario\n  };\n\n  return (\n    <Router>\n      {/* Renderiza el Header solo si el usuario está autenticado */}\n      {user && <Header user={user} logout={logout} />}\n\n      <Routes>\n        {/* Rutas públicas */}\n        <Route path=\"/\" element={<LandingPage />}/>\n        <Route path=\"/login\" element={<Login />} />\n\n        {/* Rutas para estudiantes */}\n        <Route\n          path=\"/recordings\"\n          element={\n            <ProtectedRoute requiredRole={['student']}>\n              <StudentRecordings />\n            </ProtectedRoute>\n          }\n        />\n        <Route\n          path=\"/account\"\n          element={\n            <ProtectedRoute requiredRole={['student', 'admin']}>\n              <Account />\n            </ProtectedRoute>\n          }\n        />\n\n        {/* Rutas para administradores */}\n        <Route\n          path=\"/admin\"\n          element={\n            <ProtectedRoute requiredRole={['admin']}>\n              <AdminDashboard />\n            </ProtectedRoute>\n          }\n        />\n        <Route\n          path=\"/admin/users\"\n          element={\n            <ProtectedRoute requiredRole={['admin']}>\n              <ManageUsers />\n            </ProtectedRoute>\n          }\n        />\n        <Route\n          path=\"/admin/recordings\"\n          element={\n            <ProtectedRoute requiredRole={['admin']}>\n              <ManageRecordings />\n            </ProtectedRoute>\n          }\n        />\n      </Routes>\n    </Router>\n  );\n};\n\nexport default App;\n// nuevo codigo"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,aAAa,GAAI,CAAAC,MAAM,CAAEC,KAAK,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,kBAAkB,CACnF,MAAO,CAAAC,WAAW,KAAM,qBAAqB,CAC7C,MAAO,CAAAC,KAAK,KAAM,eAAe,CACjC,MAAO,CAAAC,iBAAiB,KAAM,2BAA2B,CACzD,MAAO,CAAAC,cAAc,KAAM,wBAAwB,CACnD,MAAO,CAAAC,WAAW,KAAM,qBAAqB,CAC7C,MAAO,CAAAC,gBAAgB,KAAM,0BAA0B,CACvD,MAAO,CAAAC,OAAO,KAAM,iBAAiB,CACrC,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,OAAQC,SAAS,KAAO,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErC,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAgC,IAA/B,CAAEC,YAAY,CAAEC,QAAS,CAAC,CAAAF,IAAA,CAChD,KAAM,CAAAG,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE;AAC7C,GAAI,CAAAC,IAAI,CAAG,IAAI,CAEf,GAAIH,KAAK,CAAE,CACT,GAAI,CACFG,IAAI,CAAGZ,SAAS,CAACS,KAAK,CAAC,CAAE;AAC3B,CAAE,MAAOI,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,iBAAiB,CAAEA,KAAK,CAAC,CACzC,CACF,CAEA,GAAI,CAACD,IAAI,CAAE,CACT;AACA,mBAAOV,IAAA,CAACX,QAAQ,EAACwB,EAAE,CAAC,QAAQ,CAAE,CAAC,CACjC,CAEA,GAAI,CAACR,YAAY,CAACS,QAAQ,CAACJ,IAAI,CAACK,IAAI,CAAC,CAAE,CACrC;AACA,MAAO,CAAAL,IAAI,CAACK,IAAI,GAAK,SAAS,cAC5Bf,IAAA,CAACX,QAAQ,EAACwB,EAAE,CAAC,aAAa,CAAE,CAAC,cAE7Bb,IAAA,CAACX,QAAQ,EAACwB,EAAE,CAAC,QAAQ,CAAE,CACxB,CACH,CAEA,MAAO,CAAAP,QAAQ,CAAE;AACnB,CAAC,CAED,KAAM,CAAAU,GAAG,CAAGA,CAAA,GAAM,CAChB,KAAM,CAACN,IAAI,CAAEO,OAAO,CAAC,CAAGlC,QAAQ,CAAC,IAAI,CAAC,CAEtCC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAIF,KAAK,CAAE,CACT,GAAI,CACF,KAAM,CAAAW,WAAW,CAAGpB,SAAS,CAACS,KAAK,CAAC,CACpCU,OAAO,CAACC,WAAW,CAAC,CACtB,CAAE,MAAOP,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CACxD,CACF,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAQ,MAAM,CAAGA,CAAA,GAAM,CACnBX,YAAY,CAACY,UAAU,CAAC,OAAO,CAAC,CAAE;AAClCH,OAAO,CAAC,IAAI,CAAC,CAAE;AACjB,CAAC,CAED,mBACEf,KAAA,CAAChB,MAAM,EAAAoB,QAAA,EAEJI,IAAI,eAAIV,IAAA,CAACH,MAAM,EAACa,IAAI,CAAEA,IAAK,CAACS,MAAM,CAAEA,MAAO,CAAE,CAAC,cAE/CjB,KAAA,CAACd,MAAM,EAAAkB,QAAA,eAELN,IAAA,CAACb,KAAK,EAACkC,IAAI,CAAC,GAAG,CAACC,OAAO,cAAEtB,IAAA,CAACV,WAAW,GAAE,CAAE,CAAC,CAAC,cAC3CU,IAAA,CAACb,KAAK,EAACkC,IAAI,CAAC,QAAQ,CAACC,OAAO,cAAEtB,IAAA,CAACT,KAAK,GAAE,CAAE,CAAE,CAAC,cAG3CS,IAAA,CAACb,KAAK,EACJkC,IAAI,CAAC,aAAa,CAClBC,OAAO,cACLtB,IAAA,CAACG,cAAc,EAACE,YAAY,CAAE,CAAC,SAAS,CAAE,CAAAC,QAAA,cACxCN,IAAA,CAACR,iBAAiB,GAAE,CAAC,CACP,CACjB,CACF,CAAC,cACFQ,IAAA,CAACb,KAAK,EACJkC,IAAI,CAAC,UAAU,CACfC,OAAO,cACLtB,IAAA,CAACG,cAAc,EAACE,YAAY,CAAE,CAAC,SAAS,CAAE,OAAO,CAAE,CAAAC,QAAA,cACjDN,IAAA,CAACJ,OAAO,GAAE,CAAC,CACG,CACjB,CACF,CAAC,cAGFI,IAAA,CAACb,KAAK,EACJkC,IAAI,CAAC,QAAQ,CACbC,OAAO,cACLtB,IAAA,CAACG,cAAc,EAACE,YAAY,CAAE,CAAC,OAAO,CAAE,CAAAC,QAAA,cACtCN,IAAA,CAACP,cAAc,GAAE,CAAC,CACJ,CACjB,CACF,CAAC,cACFO,IAAA,CAACb,KAAK,EACJkC,IAAI,CAAC,cAAc,CACnBC,OAAO,cACLtB,IAAA,CAACG,cAAc,EAACE,YAAY,CAAE,CAAC,OAAO,CAAE,CAAAC,QAAA,cACtCN,IAAA,CAACN,WAAW,GAAE,CAAC,CACD,CACjB,CACF,CAAC,cACFM,IAAA,CAACb,KAAK,EACJkC,IAAI,CAAC,mBAAmB,CACxBC,OAAO,cACLtB,IAAA,CAACG,cAAc,EAACE,YAAY,CAAE,CAAC,OAAO,CAAE,CAAAC,QAAA,cACtCN,IAAA,CAACL,gBAAgB,GAAE,CAAC,CACN,CACjB,CACF,CAAC,EACI,CAAC,EACH,CAAC,CAEb,CAAC,CAED,cAAe,CAAAqB,GAAG,CAClB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}